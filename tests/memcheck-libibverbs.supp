#
# The following suppressions are suited for debug build
# of librpma on Ubuntu 20.04 used in the CircleCI.
# They may not work for any other OS, OS version,
# rdma-core version and for the release build.
#

{
   Verbs context, once it is opened, it is never closed (RXE variant).
   Memcheck:Leak
   match-leak-kinds: possible
   fun:calloc
   ...
   fun:_verbs_init_and_alloc_context
   fun:rxe_alloc_context
   fun:verbs_open_device
   ...
   fun:ucma_init_device
}

{
   Verbs device, once it is opened, it is never closed.
   Memcheck:Leak
   match-leak-kinds: possible
   fun:calloc
   ...
   fun:try_driver
   fun:try_drivers
   fun:try_all_drivers
   fun:ibverbs_get_device_list
   fun:ibv_get_device_list*
   fun:ucma_init
   ...
}

{
   Sysfs device, once it is allocated, is not freed.
   Memcheck:Leak
   match-leak-kinds: possible
   fun:calloc
   fun:find_sysfs_devs_nl_cb
   fun:nl_recvmsgs_report
   fun:nl_recvmsgs
   fun:rdmanl_get_devices
   fun:find_sysfs_devs_nl
   fun:ibverbs_get_device_list
   fun:ibv_get_device_list*
   fun:ucma_init
   ...
}

##############################################
# new suppressions for ubuntu-2204:2022.04.1
##############################################

{
   1 bytes in 1 blocks are possibly lost in loss record 1 of 13
   Memcheck:Leak
   match-leak-kinds: possible
   fun:malloc
   fun:ucma_init_device.part.0
   fun:UnknownInlinedFun
   fun:ucma_get_device
   fun:ucma_query_addr
   fun:UnknownInlinedFun
   fun:rdma_get_cm_event
   fun:ucma_complete
   fun:rdma_resolve_addr2
   fun:rpma_info_resolve_addr
   fun:rpma_utils_get_ibv_context
   ...
}

{
   640 bytes in 1 blocks are possibly lost in loss record 5 of 13
   Memcheck:Leak
   match-leak-kinds: possible
   fun:calloc
   ...
   fun:_verbs_init_and_alloc_context
   fun:rxe_alloc_context
   fun:verbs_open_device
   fun:ucma_init_device.part.0
   fun:UnknownInlinedFun
   fun:ucma_get_device
   fun:ucma_query_addr
   fun:UnknownInlinedFun
   fun:rdma_get_cm_event
   fun:ucma_complete
   fun:rdma_resolve_addr2
   fun:rpma_info_resolve_addr
   fun:rpma_utils_get_ibv_context
   ...
}

{
   88 bytes in 1 blocks are possibly lost in loss record 3 of 13
   Memcheck:Leak
   match-leak-kinds: possible
   fun:calloc
   fun:insert_cma_dev.isra.0
   fun:sync_devices_list
   fun:ucma_init
   fun:rdma_getaddrinfo
   fun:rpma_info_new
   fun:rpma_utils_get_ibv_context
   ...
}
